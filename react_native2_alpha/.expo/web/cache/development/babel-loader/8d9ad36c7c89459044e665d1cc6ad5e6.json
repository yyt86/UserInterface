{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"F:\\\\course\\\\639-UI\\\\react_native2_alpha-yyt86-main\\\\MealsView.js\";\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } it = o[Symbol.iterator](); return it.next.bind(it); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport { FAB } from 'react-native-paper';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Icon from \"@expo/vector-icons/FontAwesome5\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport AsyncStorage from '@react-native-community/async-storage';\nimport MealCard from \"./MealCard\";\nimport AddMeal from \"./AddMeal\";\n\nvar MealView = function (_React$Component) {\n  _inherits(MealView, _React$Component);\n\n  var _super = _createSuper(MealView);\n\n  function MealView(props) {\n    var _this;\n\n    _classCallCheck(this, MealView);\n\n    _this = _super.call(this, props);\n\n    _this.hideModal = function () {\n      return _this.setState({\n        visible: false\n      });\n    };\n\n    _this.state = {\n      name: \"\",\n      date: \"\",\n      foodArray: [],\n      mealArray: [],\n      accessToken: \"\",\n      username: \"\",\n      visible: false\n    };\n    return _this;\n  }\n\n  _createClass(MealView, [{\n    key: \"getStoredData\",\n    value: function getStoredData(key) {\n      var value;\n      return _regeneratorRuntime.async(function getStoredData$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(key));\n\n            case 3:\n              value = _context.sent;\n              this.setState(_defineProperty({}, key, value));\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, [[0, 7]], Promise);\n    }\n  }, {\n    key: \"deleteMeal\",\n    value: function deleteMeal(id) {\n      var _this2 = this;\n\n      fetch('https://mysqlcs639.cs.wisc.edu/meals/' + id, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-access-token': this.state.accessToken\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        alert(\"Meal has been deleted!\");\n\n        _this2.updateData();\n      }).catch(function (err) {\n        alert(\"Something went wrong! \");\n      });\n    }\n  }, {\n    key: \"handleAddMeal\",\n    value: function handleAddMeal() {\n      this.setState({\n        visible: true\n      });\n    }\n  }, {\n    key: \"getModal\",\n    value: function getModal() {\n      var _this3 = this;\n\n      if (this.state.visible) {\n        return React.createElement(AddMeal, {\n          visible: this.state.visible,\n          updateData: function updateData() {\n            return _this3.updateData();\n          },\n          hideModal: this.hideModal,\n          accessToken: this.state.accessToken,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 59,\n            columnNumber: 9\n          }\n        });\n      }\n    }\n  }, {\n    key: \"updateData\",\n    value: function updateData() {\n      var _this4 = this;\n\n      var tempMeals = [];\n      fetch('https://mysqlcs639.cs.wisc.edu/meals/', {\n        method: 'GET',\n        headers: {\n          'x-access-token': this.state.accessToken\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        _this4.setState({\n          mealArray: []\n        });\n\n        tempMeals = res.meals;\n\n        if (tempMeals !== null && typeof tempMeals !== 'undefined') {\n          var _loop = function _loop(i) {\n            var meal = tempMeals[i];\n            var mealProteins = 0.0;\n            var mealCarbo = 0.0;\n            var mealFats = 0.0;\n            var mealFoodCal = 0.0;\n            fetch('https://mysqlcs639.cs.wisc.edu/meals/' + meal.id + '/foods', {\n              method: 'GET',\n              headers: {\n                'x-access-token': _this4.state.accessToken\n              }\n            }).then(function (res2) {\n              return res2.json();\n            }).then(function (res2) {\n              tempMeals[i].foods = res2.foods;\n\n              if (res2.foods !== null && typeof res2.foods !== 'undefined') {\n                for (var _iterator = _createForOfIteratorHelperLoose(res2.foods.values()), _step; !(_step = _iterator()).done;) {\n                  var food = _step.value;\n                  mealProteins += food.protein;\n                  mealCarbo += food.carbohydrates;\n                  mealFats += food.fat;\n                  mealFoodCal += food.calories;\n                }\n              }\n\n              tempMeals[i].mealProteins = mealProteins;\n              tempMeals[i].mealCarbo = mealCarbo;\n              tempMeals[i].mealFats = mealFats;\n              tempMeals[i].mealFoodCal = mealFoodCal;\n\n              _this4.setState(function (prevState) {\n                return {\n                  mealArray: [].concat(_toConsumableArray(prevState.mealArray), [tempMeals[i]])\n                };\n              });\n            });\n          };\n\n          for (var i = 0; i < tempMeals.length; i++) {\n            _loop(i);\n          }\n        }\n\n        _this4.getMeals();\n      }).catch(function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"getMeals\",\n    value: function getMeals() {\n      var _this5 = this;\n\n      var cardList = [];\n\n      for (var i = 0; i < this.state.mealArray.length; i++) {\n        var value = this.state.mealArray[i];\n        cardList.push(React.createElement(MealCard, {\n          key: i,\n          name: value.name,\n          date: value.date,\n          food: value.food,\n          mealProteins: value.mealProteins,\n          id: value.id,\n          accessToken: this.state.accessToken,\n          mealCarbo: value.mealCarbo,\n          mealFats: value.mealFats,\n          mealFoodCal: value.mealFoodCal,\n          foods: value.foods,\n          deleteMeal: function deleteMeal(id) {\n            return _this5.deleteMeal(id);\n          },\n          select: function select(food) {\n            return _this5.select(food);\n          },\n          updateData: function updateData() {\n            return _this5.updateData();\n          },\n          navigation: this.props.navigation,\n          todaymode: false,\n          mealmode: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 21\n          }\n        }));\n      }\n\n      return cardList;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this6 = this;\n\n      return _regeneratorRuntime.async(function componentDidMount$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(this.getStoredData(\"accessToken\"));\n\n            case 2:\n              _context2.next = 4;\n              return _regeneratorRuntime.awrap(this.getStoredData(\"username\"));\n\n            case 4:\n              _context2.next = 6;\n              return _regeneratorRuntime.awrap(this.updateData());\n\n            case 6:\n              this.navListener = this.props.navigation.addListener('focus', function () {\n                _this6.updateData();\n              });\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.navListener();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this7 = this;\n\n      return React.createElement(ScrollView, {\n        style: styles.mainContainer,\n        contentContainerStyle: {\n          flexGrow: 11,\n          justifyContent: 'center',\n          alignItems: \"center\"\n        },\n        keyboardShouldPersistTaps: \"handled\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: styles.space,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }\n      }), React.createElement(View, {\n        style: {\n          flexDirection: 'row',\n          flexWrap: 'wrap'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }\n      }, React.createElement(Icon, {\n        name: \"utensils\",\n        size: 40,\n        color: \"#900\",\n        style: {\n          marginRight: 20\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 13\n        }\n      }), React.createElement(Text, {\n        style: styles.bigText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 13\n        }\n      }, \"Meals\")), React.createElement(View, {\n        style: styles.spaceSmall,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 11\n        }\n      }), React.createElement(Text, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }\n      }, \"Have a look your meals!\"), React.createElement(Text, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 13\n        }\n      }, \"Record your meals below.\"), React.createElement(FAB, {\n        icon: \"plus\",\n        medium: true,\n        style: styles.fab,\n        onPress: function onPress() {\n          return _this7.handleAddMeal();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }\n      }), this.getModal(), React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 11\n        }\n      }, this.getMeals()));\n    }\n  }]);\n\n  return MealView;\n}(React.Component);\n\nvar styles = StyleSheet.create({\n  scrollView: {\n    height: Dimensions.get('window').height\n  },\n  mainContainer: {\n    flex: 1\n  },\n  scrollViewContainer: {},\n  container: {\n    flex: 1,\n    backgroundColor: '#fff'\n  },\n  bigText: {\n    fontSize: 32,\n    fontWeight: \"700\",\n    marginBottom: 5\n  },\n  spaceSmall: {\n    width: 20,\n    height: 10\n  },\n  space: {\n    width: 20,\n    height: 20\n  },\n  buttonInline: {\n    display: \"flex\"\n  },\n  fab: {\n    alignSelf: 'flex-end',\n    position: 'absolute',\n    top: 55,\n    right: 15,\n    backgroundColor: '#900'\n  }\n});\nexport default MealView;","map":{"version":3,"sources":["F:/course/639-UI/react_native2_alpha-yyt86-main/MealsView.js"],"names":["React","FAB","Icon","AsyncStorage","MealCard","AddMeal","MealView","props","hideModal","setState","visible","state","name","date","foodArray","mealArray","accessToken","username","key","getItem","value","console","log","id","fetch","method","headers","then","res","json","alert","updateData","catch","err","tempMeals","meals","i","meal","mealProteins","mealCarbo","mealFats","mealFoodCal","res2","foods","values","food","protein","carbohydrates","fat","calories","prevState","length","getMeals","cardList","push","deleteMeal","select","navigation","getStoredData","navListener","addListener","styles","mainContainer","flexGrow","justifyContent","alignItems","space","flexDirection","flexWrap","marginRight","bigText","spaceSmall","fab","handleAddMeal","getModal","Component","StyleSheet","create","scrollView","height","Dimensions","get","flex","scrollViewContainer","container","backgroundColor","fontSize","fontWeight","marginBottom","width","buttonInline","display","alignSelf","position","top","right"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { FAB } from 'react-native-paper';\r\nimport {StyleSheet, Text, View,  ScrollView } from 'react-native';\r\nimport Icon from 'react-native-vector-icons/FontAwesome5';\r\nimport { Dimensions } from 'react-native';\r\nimport AsyncStorage from '@react-native-community/async-storage';\r\nimport MealCard from './MealCard';\r\nimport AddMeal from './AddMeal';\r\n\r\nclass MealView extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n        name: \"\",\r\n        date: \"\",\r\n        foodArray:[],\r\n        mealArray: [],\r\n        accessToken: \"\",\r\n        username: \"\",\r\n        visible: false,\r\n    }\r\n  }\r\n\r\n  async getStoredData(key){\r\n    try{\r\n        let value = await AsyncStorage.getItem(key);\r\n        this.setState({[key]: value});\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n  }\r\n\r\n  deleteMeal(id){\r\n    fetch('https://mysqlcs639.cs.wisc.edu/meals/' + id, {\r\n      method: 'DELETE',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'x-access-token': this.state.accessToken\r\n      },\r\n    })\r\n      .then(res => res.json())\r\n      .then(res => {\r\n        alert(\"Meal has been deleted!\");\r\n        this.updateData();\r\n      })\r\n      .catch(err => {\r\n        alert(\"Something went wrong! \");\r\n      });\r\n  }\r\n\r\n  hideModal = () => this.setState({visible: false});\r\n  handleAddMeal(){\r\n      this.setState({visible: true});\r\n  }\r\n\r\n  getModal(){\r\n    if(this.state.visible){\r\n      return(\r\n        <AddMeal visible={this.state.visible} updateData = {() =>this.updateData() } hideModal={this.hideModal} accessToken={this.state.accessToken} />\r\n      )\r\n    }\r\n  }\r\n\r\n\r\n  updateData(){\r\n    let tempMeals = []\r\n      fetch('https://mysqlcs639.cs.wisc.edu/meals/', {\r\n        method: 'GET',\r\n        headers: { 'x-access-token': this.state.accessToken }\r\n      })\r\n      .then(res => res.json())\r\n      .then(res => {\r\n        this.setState({mealArray: []});\r\n        tempMeals = res.meals\r\n        if(tempMeals !== null && (typeof tempMeals !== 'undefined')){\r\n          for(let i = 0; i < tempMeals.length; i++){\r\n            let meal = tempMeals[i]\r\n            let mealProteins = 0.0;\r\n            let mealCarbo = 0.0;\r\n            let mealFats = 0.0;\r\n            let mealFoodCal = 0.0;\r\n            fetch('https://mysqlcs639.cs.wisc.edu/meals/' + meal.id + '/foods', {\r\n              method: 'GET',\r\n              headers: { 'x-access-token': this.state.accessToken }\r\n            })\r\n            .then(res2 => res2.json())\r\n            .then(res2 => {\r\n              tempMeals[i].foods = res2.foods;\r\n              if(res2.foods !== null && (typeof res2.foods !== 'undefined')){\r\n                for(const food of res2.foods.values()){\r\n                  mealProteins += food.protein;\r\n                  mealCarbo += food.carbohydrates;\r\n                  mealFats += food.fat;\r\n                  mealFoodCal += food.calories;\r\n                }\r\n              }\r\n              tempMeals[i].mealProteins = mealProteins; \r\n              tempMeals[i].mealCarbo = mealCarbo; \r\n              tempMeals[i].mealFats = mealFats; \r\n              tempMeals[i].mealFoodCal = mealFoodCal;  \r\n              this.setState(prevState => ({\r\n                mealArray: [...prevState.mealArray, tempMeals[i]] \r\n              }))\r\n            })\r\n          }\r\n        }\r\n        this.getMeals();\r\n      })\r\n      .catch(err =>{console.log(err)});\r\n  }\r\n\r\n  getMeals(){\r\n    let cardList = [];\r\n    for (let i = 0; i < this.state.mealArray.length; i++){\r\n      let value = this.state.mealArray[i];\r\n      cardList.push(<MealCard key={i} name={value.name} date={value.date}\r\n                      food={value.food} mealProteins={value.mealProteins}\r\n                      id={value.id} accessToken={this.state.accessToken}\r\n                      mealCarbo={value.mealCarbo} mealFats={value.mealFats}\r\n                      mealFoodCal={value.mealFoodCal} foods={value.foods}\r\n                      deleteMeal = {(id)=>this.deleteMeal(id)} select={(food)=>this.select(food)}\r\n                    updateData = {() =>this.updateData() }  navigation={this.props.navigation} \r\n                    todaymode = {false} mealmode={true}\r\n                    />)\r\n    }\r\n    return cardList;\r\n  }\r\n   \r\n\r\n  async componentDidMount() {\r\n    await this.getStoredData(\"accessToken\");\r\n    await this.getStoredData(\"username\");\r\n    await this.updateData(); \r\n    this.navListener = this.props.navigation.addListener('focus', () => {\r\n        this.updateData();\r\n    })    \r\n\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.navListener();\r\n  }\r\n  \r\n\r\n  render() {\r\n      return (\r\n      <ScrollView style={styles.mainContainer} contentContainerStyle={{ flexGrow: 11, justifyContent: 'center', alignItems: \"center\" }} keyboardShouldPersistTaps='handled'>\r\n          <View style={styles.space} />\r\n          <View style={{ flexDirection: 'row', flexWrap: 'wrap' }}>\r\n            <Icon name=\"utensils\" size={40} color=\"#900\" style={{ marginRight: 20 }} />\r\n            <Text style={styles.bigText}>Meals</Text>\r\n          </View>\r\n          <View style={styles.spaceSmall}></View>\r\n            <Text>Have a look your meals!</Text>\r\n            <Text>Record your meals below.</Text>\r\n      \r\n          <FAB\r\n            icon=\"plus\"\r\n            medium\r\n            style={styles.fab}\r\n            onPress={() => this.handleAddMeal()}\r\n          />\r\n          {this.getModal()}\r\n          <View>{this.getMeals()}</View>\r\n      </ScrollView>)\r\n    }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    scrollView: {\r\n        height: Dimensions.get('window').height\r\n      },\r\n      mainContainer: {\r\n        flex: 1\r\n      },\r\n      scrollViewContainer: {},\r\n      container: {\r\n        flex: 1,\r\n        backgroundColor: '#fff',\r\n      },\r\n      bigText: {\r\n        fontSize: 32,\r\n        fontWeight: \"700\",\r\n        marginBottom: 5\r\n      },\r\n      spaceSmall: {\r\n        width: 20,\r\n        height: 10,\r\n      },\r\n      space: {\r\n        width: 20,\r\n        height: 20,\r\n      },\r\n      buttonInline: {\r\n        display: \"flex\"\r\n      },\r\n\r\n      fab: {\r\n        alignSelf: 'flex-end',\r\n        position: 'absolute',\r\n        top: 55,\r\n        right: 15,\r\n        backgroundColor: '#900',\r\n     },\r\n      \r\n});\r\n\r\nexport default MealView;"]},"metadata":{},"sourceType":"module"}