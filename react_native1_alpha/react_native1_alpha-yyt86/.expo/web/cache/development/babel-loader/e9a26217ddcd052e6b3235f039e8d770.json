{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"F:\\\\course\\\\639-UI\\\\react_native2_alpha-yyt86-main\\\\MealsView.js\";\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } it = o[Symbol.iterator](); return it.next.bind(it); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport moment from \"moment\";\nimport { Modal, Portal, Title, Provider, FAB } from 'react-native-paper';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Icon from \"@expo/vector-icons/FontAwesome5\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport AsyncStorage from '@react-native-community/async-storage';\nimport MealCard from \"./MealCard\";\nimport MealModal from \"./MealModal\";\nimport AddMeal from \"./AddMeal\";\nimport { useIsFocused } from '@react-navigation/native';\n\nvar MealView = function (_React$Component) {\n  _inherits(MealView, _React$Component);\n\n  var _super = _createSuper(MealView);\n\n  function MealView(props) {\n    var _this;\n\n    _classCallCheck(this, MealView);\n\n    _this = _super.call(this, props);\n\n    _this.hideModal = function () {\n      return _this.setState({\n        visible: false\n      });\n    };\n\n    _this.state = {\n      name: \"\",\n      duration: 0.0,\n      date: \"\",\n      calories: 0.0,\n      mealArray: [],\n      accessToken: \"\",\n      username: \"\",\n      visible: false\n    };\n    return _this;\n  }\n\n  _createClass(MealView, [{\n    key: \"getStoredData\",\n    value: function getStoredData(key) {\n      var value;\n      return _regeneratorRuntime.async(function getStoredData$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(key));\n\n            case 3:\n              value = _context.sent;\n              this.setState(_defineProperty({}, key, value));\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, [[0, 7]], Promise);\n    }\n  }, {\n    key: \"deleteMeal\",\n    value: function deleteMeal(id) {\n      fetch('https://mysqlcs639.cs.wisc.edu/meals/' + id, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-access-token': this.state.accessToken\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        alert(\"Mealhas been deleted!\");\n      }).catch(function (err) {\n        alert(\"Something went wrong! \");\n      });\n      this.updateData();\n    }\n  }, {\n    key: \"handleAddActivity\",\n    value: function handleAddActivity() {\n      this.setState({\n        visible: true\n      });\n    }\n  }, {\n    key: \"getModal\",\n    value: function getModal() {\n      var _this2 = this;\n\n      if (this.state.visible) {\n        return React.createElement(AddMeal, {\n          visible: this.state.visible,\n          updateData: function updateData() {\n            return _this2.updateData();\n          },\n          hideModal: this.hideModal,\n          accessToken: this.state.accessToken,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 15\n          }\n        });\n      }\n    }\n  }, {\n    key: \"updateData\",\n    value: function updateData() {\n      var _this3 = this;\n\n      var tempMeals = [];\n      fetch('https://mysqlcs639.cs.wisc.edu/meals/', {\n        method: 'GET',\n        headers: {\n          'x-access-token': this.state.accessToken\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        console.log(res, \"res meals\");\n\n        _this3.setState({\n          mealArray: []\n        });\n\n        tempMeals = res.meals;\n\n        var _loop = function _loop(i) {\n          var meal = tempMeals[i];\n          var mealProteins = 0.0;\n          var mealCarbo = 0.0;\n          var mealFats = 0.0;\n          var mealFoodCal = 0.0;\n          fetch('https://mysqlcs639.cs.wisc.edu/meals/' + meal.id + '/foods', {\n            method: 'GET',\n            headers: {\n              'x-access-token': _this3.state.accessToken\n            }\n          }).then(function (res2) {\n            return res2.json();\n          }).then(function (res2) {\n            tempMeals[i].foods = res2.foods;\n\n            for (var _iterator = _createForOfIteratorHelperLoose(res2.foods.values()), _step; !(_step = _iterator()).done;) {\n              var food = _step.value;\n              mealProteins += food.protein;\n              mealCarbo += food.carbohydrates;\n              mealFats += food.fat;\n              mealFoodCal += food.calories;\n            }\n\n            tempMeals[i].mealProteins = mealProteins;\n            tempMeals[i].mealCarbo = mealCarbo;\n            tempMeals[i].mealFats = mealFats;\n            tempMeals[i].mealFoodCal = mealFoodCal;\n            console.log(tempMeals[i], \"tempMeals[i]\");\n\n            _this3.setState(function (prevState) {\n              return {\n                mealArray: [].concat(_toConsumableArray(prevState.mealArray), [tempMeals[i]])\n              };\n            });\n\n            console.log(_this3.state.mealArray, \"this.state.mealArray\");\n          });\n        };\n\n        for (var i = 0; i < tempMeals.length; i++) {\n          _loop(i);\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"getMeals\",\n    value: function getMeals() {\n      var _this4 = this;\n\n      var cardList = [];\n\n      for (var i = 0; i < this.state.mealArray.length; i++) {\n        var value = this.state.mealArray[i];\n        cardList.push(React.createElement(MealCard, {\n          key: i,\n          name: value.name,\n          date: value.date,\n          food: value.food,\n          mealProteins: value.mealProteins,\n          id: value.id,\n          accessToken: this.state.accessToken,\n          mealCarbo: value.mealCarbo,\n          mealFats: value.mealFats,\n          mealFoodCal: value.mealFoodCal,\n          foods: value.foods,\n          deleteExercise: function deleteExercise(id) {\n            return _this4.deleteExercise(id);\n          },\n          updateData: function updateData() {\n            return _this4.updateData();\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 27\n          }\n        }));\n      }\n\n      return cardList;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      return _regeneratorRuntime.async(function componentDidMount$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(this.getStoredData(\"accessToken\"));\n\n            case 2:\n              _context2.next = 4;\n              return _regeneratorRuntime.awrap(this.getStoredData(\"username\"));\n\n            case 4:\n              this.updateData();\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      return React.createElement(ScrollView, {\n        style: styles.mainContainer,\n        contentContainerStyle: {\n          flexGrow: 11,\n          justifyContent: 'center',\n          alignItems: \"center\"\n        },\n        keyboardShouldPersistTaps: \"handled\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 9\n        }\n      }, React.createElement(View, {\n        style: styles.space,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 13\n        }\n      }), React.createElement(View, {\n        style: {\n          flexDirection: 'row',\n          flexWrap: 'wrap'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 13\n        }\n      }, React.createElement(Icon, {\n        name: \"utensils\",\n        size: 40,\n        color: \"#900\",\n        style: {\n          marginRight: 20\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 13\n        }\n      }), React.createElement(Text, {\n        style: styles.bigText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 11\n        }\n      }, \"Meals\")), React.createElement(View, {\n        style: styles.spaceSmall,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 13\n        }\n      }), React.createElement(Text, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }\n      }, \"Have a look your meals!\"), React.createElement(Text, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }\n      }, \"Record your meals below.\"), React.createElement(FAB, {\n        icon: \"plus\",\n        medium: true,\n        style: styles.fab,\n        onPress: function onPress() {\n          return _this5.handleAddActivity();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return MealView;\n}(React.Component);\n\nvar styles = StyleSheet.create({\n  scrollView: {\n    height: Dimensions.get('window').height\n  },\n  mainContainer: {\n    flex: 1\n  },\n  scrollViewContainer: {},\n  container: {\n    flex: 1,\n    backgroundColor: '#fff'\n  },\n  bigText: {\n    fontSize: 32,\n    fontWeight: \"700\",\n    marginBottom: 5\n  },\n  spaceSmall: {\n    width: 20,\n    height: 10\n  },\n  space: {\n    width: 20,\n    height: 20\n  },\n  buttonInline: {\n    display: \"flex\"\n  },\n  fab: {\n    alignSelf: 'flex-end',\n    position: 'absolute',\n    top: 55,\n    right: 15,\n    backgroundColor: '#900'\n  }\n});\nexport default MealView;","map":{"version":3,"sources":["F:/course/639-UI/react_native2_alpha-yyt86-main/MealsView.js"],"names":["React","moment","Modal","Portal","Title","Provider","FAB","Icon","AsyncStorage","MealCard","MealModal","AddMeal","useIsFocused","MealView","props","hideModal","setState","visible","state","name","duration","date","calories","mealArray","accessToken","username","key","getItem","value","console","log","id","fetch","method","headers","then","res","json","alert","catch","err","updateData","tempMeals","meals","i","meal","mealProteins","mealCarbo","mealFats","mealFoodCal","res2","foods","values","food","protein","carbohydrates","fat","prevState","length","cardList","push","deleteExercise","getStoredData","styles","mainContainer","flexGrow","justifyContent","alignItems","space","flexDirection","flexWrap","marginRight","bigText","spaceSmall","fab","handleAddActivity","Component","StyleSheet","create","scrollView","height","Dimensions","get","flex","scrollViewContainer","container","backgroundColor","fontSize","fontWeight","marginBottom","width","buttonInline","display","alignSelf","position","top","right"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport moment from \"moment\";\r\nimport { Modal, Portal, Title, Provider, FAB } from 'react-native-paper';\r\nimport {StyleSheet, Text, View, Button, TextInput, ScrollView } from 'react-native';\r\nimport Icon from 'react-native-vector-icons/FontAwesome5';\r\nimport { Dimensions } from 'react-native';\r\nimport AsyncStorage from '@react-native-community/async-storage';\r\nimport MealCard from './MealCard';\r\nimport MealModal from './MealModal';\r\nimport AddMeal from './AddMeal';\r\nimport { useIsFocused } from '@react-navigation/native'\r\n// import { withNavigation, NavigationEvents } from 'react-navigation';\r\n\r\n\r\n\r\nclass MealView extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            name: \"\",\r\n            duration: 0.0,\r\n            date: \"\",\r\n            calories: 0.0,\r\n            mealArray: [],\r\n            accessToken: \"\",\r\n            username: \"\",\r\n            visible: false,\r\n          }\r\n\r\n    }\r\n\r\n    async getStoredData(key){\r\n        try{\r\n            let value = await AsyncStorage.getItem(key);\r\n            this.setState({[key]: value});\r\n         } catch (error) {\r\n            console.log(error);\r\n         }\r\n    }\r\n\r\n    deleteMeal(id){\r\n        fetch('https://mysqlcs639.cs.wisc.edu/meals/' + id, {\r\n          method: 'DELETE',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'x-access-token': this.state.accessToken\r\n          },\r\n        })\r\n          .then(res => res.json())\r\n          .then(res => {\r\n            alert(\"Mealhas been deleted!\");\r\n\r\n          })\r\n          .catch(err => {\r\n            alert(\"Something went wrong! \");\r\n          });\r\n          this.updateData();\r\n    \r\n    }\r\n\r\n    hideModal = () => this.setState({visible: false});\r\n    handleAddActivity(){\r\n        this.setState({visible: true});\r\n\r\n        // return(\r\n           \r\n        // )\r\n    }\r\n\r\n    getModal(){\r\n      if(this.state.visible){\r\n          return(\r\n              <AddMeal visible={this.state.visible} updateData = {() =>this.updateData() } hideModal={this.hideModal} accessToken={this.state.accessToken} />\r\n          )\r\n      }\r\n  }\r\n\r\n    updateData(){\r\n      let tempMeals = []\r\n      // let todayProteins = 0.0;\r\n      // let todayCarbo = 0.0;\r\n      // let todayFats = 0.0;\r\n      // let todayFoodCal = 0.0;\r\n        fetch('https://mysqlcs639.cs.wisc.edu/meals/', {\r\n          method: 'GET',\r\n          headers: { 'x-access-token': this.state.accessToken }\r\n        })\r\n          .then(res => res.json())\r\n          .then(res => {\r\n            console.log(res, \"res meals\")\r\n              // this.setState({mealArray:  res.meals});\r\n              this.setState({mealArray: []});\r\n              tempMeals = res.meals\r\n               for(let i = 0; i < tempMeals.length; i++){\r\n                 let meal = tempMeals[i]\r\n                 \r\n                 let mealProteins = 0.0;\r\n                 let mealCarbo = 0.0;\r\n                let mealFats = 0.0;\r\n                let mealFoodCal = 0.0;\r\n                  fetch('https://mysqlcs639.cs.wisc.edu/meals/' + meal.id + '/foods', {\r\n                        method: 'GET',\r\n                         headers: { 'x-access-token': this.state.accessToken }\r\n                     })\r\n                    .then(res2 => res2.json())\r\n                    .then(res2 => {\r\n                      // let foodlist = [];\r\n                      // foodlist = res2.foods;\r\n                      tempMeals[i].foods = res2.foods;\r\n                        for(const food of res2.foods.values()){\r\n                            mealProteins += food.protein;\r\n                            mealCarbo += food.carbohydrates;\r\n                            mealFats += food.fat;\r\n                            mealFoodCal += food.calories;\r\n                        }\r\n                        tempMeals[i].mealProteins = mealProteins; \r\n                        tempMeals[i].mealCarbo = mealCarbo; \r\n                        tempMeals[i].mealFats = mealFats; \r\n                        tempMeals[i].mealFoodCal = mealFoodCal;  \r\n                      // this.setState({dailyProtein: todayProteins})\r\n                      // this.setState({dailyCarbo: todayCarbo})\r\n                      // this.setState({dailyFats: todayFats})\r\n                      // this.setState({dailyFoodCal: todayFoodCal})\r\n                      console.log(tempMeals[i], \"tempMeals[i]\")\r\n                      this.setState(prevState => ({\r\n                        mealArray: [...prevState.mealArray, tempMeals[i]] \r\n                      }))\r\n                      console.log(this.state.mealArray, \"this.state.mealArray\")\r\n                    })\r\n                  }\r\n                    \r\n                      // console.log(tempMeals, \"tempMeals\")\r\n                      //  this.setState({mealArray: tempMeals});\r\n                        // console.log(this.state.mealArray, \"this.state.mealArray\")\r\n                    \r\n                   \r\n                  // this.getMeals();\r\n                })\r\n          .catch(err =>{console.log(err)});\r\n    }\r\n\r\n    getMeals(){\r\n      // this.updateData();\r\n        let cardList = [];\r\n        // console.log(this.state.activityArray, \"activity\")\r\n        for (let i = 0; i < this.state.mealArray.length; i++){\r\n        // for(const key of this.state.activityArray.keys()){\r\n          let value = this.state.mealArray[i];\r\n          // console.log(value, \"activity info\")\r\n          // console.log(value.id, \"activity id\")\r\n          \r\n            cardList.push(<MealCard key={i} name={value.name} date={value.date}\r\n                           food={value.food} mealProteins={value.mealProteins}\r\n                           id={value.id} accessToken={this.state.accessToken}\r\n                           mealCarbo={value.mealCarbo} mealFats={value.mealFats}\r\n                           mealFoodCal={value.mealFoodCal} foods={value.foods}\r\n                           deleteExercise = {(id)=>this.deleteExercise(id)} \r\n                          updateData = {() =>this.updateData() }/>)\r\n\r\n        }\r\n        return cardList;\r\n    }\r\n   \r\n\r\n    async componentDidMount() {\r\n        await this.getStoredData(\"accessToken\");\r\n        await this.getStoredData(\"username\");\r\n        \r\n        // console.log(this.state.accessToken)\r\n        this.updateData();\r\n      \r\n        // this.navListener = this.props.navigation.addListener('didFocus', () => {\r\n        //   this.updateData();\r\n          \r\n      //  });\r\n    //   if(this.props.isFocused){\r\n    //     this.updateData();\r\n    //   // }\r\n    }\r\n\r\n  //   componentWillUnmount() {\r\n \r\n  //     this.navListener();\r\n  //  }\r\n  \r\n\r\n    render() {\r\n      // const { isFocused } = this.props;\r\n        return (\r\n        <ScrollView style={styles.mainContainer} contentContainerStyle={{ flexGrow: 11, justifyContent: 'center', alignItems: \"center\" }} keyboardShouldPersistTaps='handled'>\r\n            <View style={styles.space} />\r\n            <View style={{ flexDirection: 'row', flexWrap: 'wrap' }}>\r\n            <Icon name=\"utensils\" size={40} color=\"#900\" style={{ marginRight: 20 }} />\r\n          <Text style={styles.bigText}>Meals</Text>\r\n            </View>\r\n            <View style={styles.spaceSmall}></View>\r\n          <Text>Have a look your meals!</Text>\r\n          <Text>Record your meals below.</Text>\r\n        {/* <View style={styles.space} />\r\n        <Button color=\"#942a21\" style={styles.buttonInline} title=\"ADD ACTIVITY\" onPress={() => this.handleAddActivity()} />\r\n        <View style={styles.space} /> */}\r\n        <FAB\r\n               icon=\"plus\"\r\n               medium\r\n              //  size={35}\r\n               style={styles.fab}\r\n               onPress={() => this.handleAddActivity()}\r\n            />\r\n            {/* {this.getModal()} */}\r\n             {/* <ActivityModal visible={this.state.visible} hideModal={this.hideModal} accessToken={this.state.accessToken} addmode={true} editmode={false}/> */}\r\n        {/* <View>{isFocused? this.updateData(): this.empty()}</View> */}\r\n        \r\n        {/* <NavigationEvents\r\n              onWillFocus={() => {\r\n                this.updateData()\r\n              }}\r\n            /> */}\r\n            {/* <View>{this.getMeals()}</View> */}\r\n        </ScrollView>)\r\n    }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    scrollView: {\r\n        height: Dimensions.get('window').height\r\n      },\r\n      mainContainer: {\r\n        flex: 1\r\n      },\r\n      scrollViewContainer: {},\r\n      container: {\r\n        flex: 1,\r\n        backgroundColor: '#fff',\r\n      },\r\n      bigText: {\r\n        fontSize: 32,\r\n        fontWeight: \"700\",\r\n        marginBottom: 5\r\n      },\r\n      spaceSmall: {\r\n        width: 20,\r\n        height: 10,\r\n      },\r\n      space: {\r\n        width: 20,\r\n        height: 20,\r\n      },\r\n      buttonInline: {\r\n        display: \"flex\"\r\n      },\r\n\r\n      fab: {\r\n        alignSelf: 'flex-end',\r\n        position: 'absolute',\r\n        top: 55,\r\n        right: 15,\r\n        backgroundColor: '#900',\r\n     },\r\n      \r\n});\r\n\r\nexport default MealView;\r\n// export default withNavigation(ExercisesView);\r\n// export default function(props) {\r\n//   const isFocused = useIsFocused();\r\n\r\n//   return <ExercisesView {...props} isFocused={isFocused} />;\r\n// }"]},"metadata":{},"sourceType":"module"}